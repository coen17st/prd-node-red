[
  {
    "id": "7bd54a92.9df5d4",
    "type": "tab",
    "label": "update_notification_firmware_shelly",
    "disabled": true,
    "info": ""
  },
  {
    "id": "eb453bd8.ef7508",
    "type": "ha-get-entities",
    "z": "7bd54a92.9df5d4",
    "name": "",
    "server": "4ba92433.2478cc",
    "version": 0,
    "rules": [
      {
        "property": "entity_id",
        "logic": "starts_with",
        "value": "binary_sensor.",
        "valueType": "str"
      }
    ],
    "output_type": "split",
    "output_empty_results": false,
    "output_location_type": "msg",
    "output_location": "payload",
    "output_results_count": 1,
    "x": 570,
    "y": 100,
    "wires": [
      [
        "e0125027.d7118"
      ]
    ]
  },
  {
    "id": "54f37ef6.18154",
    "type": "template",
    "z": "7bd54a92.9df5d4",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "Er is een {{payload.attributes.shelly_type}} firmware update beschikbaar voor {{payload.attributes.shelly_id}} met IP-adres {{payload.attributes.ip_address}}. \\n \\nHuidige Firmware versie: {{payload.attributes.firmware_version}}\\n Beschikbare Firmware versie: {{payload.attributes.latest_fw_version}}",
    "output": "str",
    "x": 960,
    "y": 100,
    "wires": [
      [
        "f2ccd49b.02d018"
      ]
    ]
  },
  {
    "id": "f2ccd49b.02d018",
    "type": "change",
    "z": "7bd54a92.9df5d4",
    "name": "",
    "rules": [
      {
        "t": "set",
        "p": "topic",
        "pt": "msg",
        "to": "Update",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1110,
    "y": 100,
    "wires": [
      [
        "dcf0faf5.c11678"
      ]
    ]
  },
  {
    "id": "dcf0faf5.c11678",
    "type": "api-call-service",
    "z": "7bd54a92.9df5d4",
    "name": "In APP Notify",
    "server": "4ba92433.2478cc",
    "version": 3,
    "debugenabled": false,
    "service_domain": "persistent_notification",
    "service": "create",
    "entityId": "",
    "data": "{\"message\":\"{{message}}\",\"title\":\"{{topic}}\"}",
    "dataType": "json",
    "mergecontext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1270,
    "y": 100,
    "wires": [
      [
        "3987aa4e.aa7646"
      ]
    ]
  },
  {
    "id": "b3dfa4a.f848158",
    "type": "inject",
    "z": "7bd54a92.9df5d4",
    "name": "Every day @ 09:00",
    "props": [
      {
        "p": "payload"
      },
      {
        "p": "topic",
        "vt": "str"
      }
    ],
    "repeat": "",
    "crontab": "00 09 * * *",
    "once": false,
    "onceDelay": 0.1,
    "topic": "",
    "payload": "",
    "payloadType": "date",
    "x": 120,
    "y": 100,
    "wires": [
      [
        "2c62a069.dd1a1"
      ]
    ]
  },
  {
    "id": "f8f4425e.795dc",
    "type": "server-state-changed",
    "z": "7bd54a92.9df5d4",
    "name": "firmware_update is on",
    "server": "4ba92433.2478cc",
    "version": 3,
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "entityidfilter": "firmware_update",
    "entityidfiltertype": "regex",
    "outputinitially": true,
    "state_type": "str",
    "haltifstate": "on",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "outputs": 2,
    "output_only_on_state_change": true,
    "for": "",
    "forType": "num",
    "forUnits": "minutes",
    "ignorePrevStateNull": false,
    "ignorePrevStateUnknown": true,
    "ignorePrevStateUnavailable": true,
    "ignoreCurrentStateUnknown": true,
    "ignoreCurrentStateUnavailable": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "",
        "valueType": "triggerId"
      }
    ],
    "x": 120,
    "y": 140,
    "wires": [
      [
        "2c62a069.dd1a1"
      ],
      []
    ]
  },
  {
    "id": "e0125027.d7118",
    "type": "switch",
    "z": "7bd54a92.9df5d4",
    "name": "regex \"Upgrade firmware\"",
    "property": "payload.attributes.friendly_name",
    "propertyType": "msg",
    "rules": [
      {
        "t": "regex",
        "v": "Firmware Update",
        "vt": "str",
        "case": false
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 1,
    "x": 770,
    "y": 100,
    "wires": [
      [
        "54f37ef6.18154"
      ]
    ]
  },
  {
    "id": "2c62a069.dd1a1",
    "type": "stoptimer",
    "z": "7bd54a92.9df5d4",
    "duration": "10",
    "units": "Second",
    "payloadtype": "num",
    "payloadval": "0",
    "name": "",
    "x": 390,
    "y": 100,
    "wires": [
      [
        "eb453bd8.ef7508"
      ],
      []
    ]
  },
  {
    "id": "3987aa4e.aa7646",
    "type": "subflow:3a85158d.efd05a",
    "z": "7bd54a92.9df5d4",
    "name": "",
    "x": 1430,
    "y": 100,
    "wires": []
  },
  {
    "id": "8ab9f579.759ce8",
    "type": "comment",
    "z": "7bd54a92.9df5d4",
    "name": "notification when shelly devices has firmware update",
    "info": "",
    "x": 210,
    "y": 40,
    "wires": []
  }
]