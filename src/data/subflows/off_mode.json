[
  {
    "id": "79544bf2.1ff3a4",
    "type": "subflow",
    "name": "off_mode",
    "info": "",
    "category": "",
    "in": [
      {
        "x": 40,
        "y": 100,
        "wires": [
          {
            "id": "f9028094.57a62"
          },
          {
            "id": "e0b2428a.a371b"
          },
          {
            "id": "83808dcd.70439"
          },
          {
            "id": "5644cdae.e32cc4"
          },
          {
            "id": "8f9f8583.d61818"
          },
          {
            "id": "70042c68d7934e2a"
          },
          {
            "id": "db8cc8f4bb9386ab"
          }
        ]
      }
    ],
    "out": [],
    "env": [],
    "meta": {},
    "color": "#DDAA99"
  },
  {
    "id": "3b9a1fc1.aafd9",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "input select harmonyhub alles uit",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "input_select",
    "service": "select_option",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_select.harmonyhub"
    ],
    "data": "{\"option\":\"Alles Uit\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 600,
    "y": 300,
    "wires": [
      []
    ]
  },
  {
    "id": "f9028094.57a62",
    "type": "ha-get-entities",
    "z": "79544bf2.1ff3a4",
    "name": "lookup climate is not auto",
    "server": "4ba92433.2478cc",
    "version": 0,
    "rules": [
      {
        "property": "entity_id",
        "logic": "starts_with",
        "value": "climate.",
        "valueType": "str"
      },
      {
        "property": "state",
        "logic": "is_not",
        "value": "auto",
        "valueType": "str"
      }
    ],
    "output_type": "split",
    "output_empty_results": false,
    "output_location_type": "msg",
    "output_location": "payload",
    "output_results_count": 1,
    "x": 230,
    "y": 420,
    "wires": [
      [
        "397bbd3d.0bb3f2"
      ]
    ]
  },
  {
    "id": "397bbd3d.0bb3f2",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "turn on climate auto mode",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "climate",
    "service": "set_hvac_mode",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "{{payload.entity_id}}"
    ],
    "data": "{\"hvac_mode\":\"auto\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 570,
    "y": 420,
    "wires": [
      [
        "477c8f0e.c4289"
      ]
    ]
  },
  {
    "id": "477c8f0e.c4289",
    "type": "join",
    "z": "79544bf2.1ff3a4",
    "name": "",
    "mode": "custom",
    "build": "string",
    "property": "payload.attributes.friendly_name",
    "propertyType": "msg",
    "key": "topic",
    "joiner": ", ",
    "joinerType": "str",
    "accumulate": false,
    "timeout": "",
    "count": "",
    "reduceRight": false,
    "reduceExp": "",
    "reduceInit": "",
    "reduceInitType": "",
    "reduceFixup": "",
    "x": 970,
    "y": 420,
    "wires": [
      [
        "b85d118c.fbdc4"
      ]
    ]
  },
  {
    "id": "b85d118c.fbdc4",
    "type": "template",
    "z": "79544bf2.1ff3a4",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "De verwarming in {{{payload.attributes.friendly_name}}} is van handmatig naar automatische stand geschakeld.",
    "output": "str",
    "x": 1100,
    "y": 420,
    "wires": [
      [
        "ad7f00b7b2b0e671"
      ]
    ]
  },
  {
    "id": "e0b2428a.a371b",
    "type": "ha-get-entities",
    "z": "79544bf2.1ff3a4",
    "name": "lookup lights on",
    "server": "4ba92433.2478cc",
    "version": 0,
    "rules": [
      {
        "property": "entity_id",
        "logic": "starts_with",
        "value": "light.",
        "valueType": "str"
      },
      {
        "property": "state",
        "logic": "is",
        "value": "on",
        "valueType": "str"
      }
    ],
    "output_type": "split",
    "output_empty_results": false,
    "output_location_type": "msg",
    "output_location": "payload",
    "output_results_count": 1,
    "x": 200,
    "y": 480,
    "wires": [
      [
        "9eb23897.6d9b38"
      ]
    ]
  },
  {
    "id": "9eb23897.6d9b38",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "turn off lights",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "light",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "{{payload.entity_id}}"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 530,
    "y": 480,
    "wires": [
      [
        "fda4eae176ed738e"
      ]
    ]
  },
  {
    "id": "83808dcd.70439",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "turn off water heater",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "water_heater",
    "service": "set_operation_mode",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "water_heater.warm_water"
    ],
    "data": "{\"operation_mode\":\"off\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 220,
    "y": 220,
    "wires": [
      []
    ]
  },
  {
    "id": "c57acb4f.9d1808",
    "type": "comment",
    "z": "79544bf2.1ff3a4",
    "name": "off mode actions",
    "info": "",
    "x": 100,
    "y": 40,
    "wires": []
  },
  {
    "id": "5644cdae.e32cc4",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "turn off childlock kitchen",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "switch",
    "service": "turn_off",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "switch.childlock_kitchen_switch"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 230,
    "y": 160,
    "wires": [
      []
    ]
  },
  {
    "id": "8f9f8583.d61818",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "input select spotify playlist spotify uit",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "input_select",
    "service": "select_option",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_select.spotify_playlist"
    ],
    "data": "{\"option\":\"Spotify Uit\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 270,
    "y": 360,
    "wires": [
      []
    ]
  },
  {
    "id": "a680c17548559ce2",
    "type": "link out",
    "z": "79544bf2.1ff3a4",
    "name": "",
    "links": [],
    "x": 1375,
    "y": 440,
    "wires": []
  },
  {
    "id": "ad7f00b7b2b0e671",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "In APP Notify",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "persistent_notification",
    "service": "create",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"{{message}}\",\"title\":\"Verwarming\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1250,
    "y": 420,
    "wires": [
      [
        "a680c17548559ce2"
      ]
    ]
  },
  {
    "id": "fda4eae176ed738e",
    "type": "template",
    "z": "79544bf2.1ff3a4",
    "name": "format friendly name",
    "field": "friendly_name",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "{{{payload.attributes.friendly_name}}}",
    "output": "str",
    "x": 800,
    "y": 480,
    "wires": [
      [
        "58d0a2479b16b408"
      ]
    ]
  },
  {
    "id": "58d0a2479b16b408",
    "type": "join",
    "z": "79544bf2.1ff3a4",
    "name": "",
    "mode": "custom",
    "build": "string",
    "property": "friendly_name",
    "propertyType": "msg",
    "key": "topic",
    "joiner": ", ",
    "joinerType": "str",
    "accumulate": false,
    "timeout": "",
    "count": "",
    "reduceRight": false,
    "reduceExp": "",
    "reduceInit": "",
    "reduceInitType": "",
    "reduceFixup": "",
    "x": 970,
    "y": 480,
    "wires": [
      [
        "89625810ae98a2fc"
      ]
    ]
  },
  {
    "id": "89625810ae98a2fc",
    "type": "template",
    "z": "79544bf2.1ff3a4",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "{{{friendly_name}}} verlichting stond nog aan en is nu automatisch uitgeschakeld.",
    "output": "str",
    "x": 1100,
    "y": 480,
    "wires": [
      [
        "a8dadd67cf109c6d"
      ]
    ]
  },
  {
    "id": "a8dadd67cf109c6d",
    "type": "api-call-service",
    "z": "79544bf2.1ff3a4",
    "name": "In APP Notify",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "persistent_notification",
    "service": "create",
    "areaId": [],
    "deviceId": [],
    "entityId": [],
    "data": "{\"message\":\"{{message}}\",\"title\":\"Verlichting\"}",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1250,
    "y": 480,
    "wires": [
      [
        "a680c17548559ce2"
      ]
    ]
  },
  {
    "id": "70042c68d7934e2a",
    "type": "subflow:b93cc1561f32248d",
    "z": "79544bf2.1ff3a4",
    "name": "",
    "x": 260,
    "y": 100,
    "wires": []
  },
  {
    "id": "db8cc8f4bb9386ab",
    "type": "api-current-state",
    "z": "79544bf2.1ff3a4",
    "name": "state input select is all off",
    "server": "4ba92433.2478cc",
    "version": 3,
    "outputs": 2,
    "halt_if": "Alles Uit",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_select.harmonyhub",
    "state_type": "str",
    "blockInputOverrides": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 230,
    "y": 280,
    "wires": [
      [
        "8b596edabf419a04"
      ],
      [
        "3b9a1fc1.aafd9"
      ]
    ]
  },
  {
    "id": "8b596edabf419a04",
    "type": "subflow:0f710598d50e0596",
    "z": "79544bf2.1ff3a4",
    "name": "",
    "x": 530,
    "y": 260,
    "wires": []
  }
]