[
  {
    "id": "8aa6edec.5a013",
    "type": "tab",
    "label": "away_desired_state",
    "disabled": false,
    "info": ""
  },
  {
    "id": "fd0992d579e52c73",
    "type": "junction",
    "z": "8aa6edec.5a013",
    "x": 300,
    "y": 220,
    "wires": [
      [
        "fc85d1e2.ac029"
      ]
    ]
  },
  {
    "id": "76fc5cd8933d341b",
    "type": "junction",
    "z": "8aa6edec.5a013",
    "x": 680,
    "y": 180,
    "wires": [
      [
        "8afb3387.bc64f"
      ]
    ]
  },
  {
    "id": "a8b7af48.25638",
    "type": "server-state-changed",
    "z": "8aa6edec.5a013",
    "name": "state group persons not_home",
    "server": "4ba92433.2478cc",
    "version": 4,
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "entityidfilter": "group.persons",
    "entityidfiltertype": "exact",
    "outputinitially": true,
    "state_type": "str",
    "haltifstate": "not_home",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "outputs": 2,
    "output_only_on_state_change": true,
    "for": "",
    "forType": "num",
    "forUnits": "minutes",
    "ignorePrevStateNull": false,
    "ignorePrevStateUnknown": true,
    "ignorePrevStateUnavailable": true,
    "ignoreCurrentStateUnknown": true,
    "ignoreCurrentStateUnavailable": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "",
        "valueType": "triggerId"
      }
    ],
    "x": 140,
    "y": 100,
    "wires": [
      [
        "99dc8873.517068"
      ],
      []
    ]
  },
  {
    "id": "81ed119.13c84f",
    "type": "server-state-changed",
    "z": "8aa6edec.5a013",
    "name": "state guest off",
    "server": "4ba92433.2478cc",
    "version": 4,
    "exposeToHomeAssistant": false,
    "haConfig": [
      {
        "property": "name",
        "value": ""
      },
      {
        "property": "icon",
        "value": ""
      }
    ],
    "entityidfilter": "input_boolean.guest",
    "entityidfiltertype": "exact",
    "outputinitially": false,
    "state_type": "str",
    "haltifstate": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "outputs": 2,
    "output_only_on_state_change": true,
    "for": "",
    "forType": "num",
    "forUnits": "minutes",
    "ignorePrevStateNull": false,
    "ignorePrevStateUnknown": true,
    "ignorePrevStateUnavailable": true,
    "ignoreCurrentStateUnknown": true,
    "ignoreCurrentStateUnavailable": true,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "eventData"
      },
      {
        "property": "topic",
        "propertyType": "msg",
        "value": "",
        "valueType": "triggerId"
      }
    ],
    "x": 90,
    "y": 160,
    "wires": [
      [
        "86e3be2e.bc7b4"
      ],
      [
        "fd0992d579e52c73"
      ]
    ]
  },
  {
    "id": "99dc8873.517068",
    "type": "api-current-state",
    "z": "8aa6edec.5a013",
    "name": "state guest off",
    "server": "4ba92433.2478cc",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.guest",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 380,
    "y": 100,
    "wires": [
      [
        "49ea77ab.4cfa28",
        "8d40faa88a9cd112"
      ],
      []
    ]
  },
  {
    "id": "86e3be2e.bc7b4",
    "type": "api-current-state",
    "z": "8aa6edec.5a013",
    "name": "state group persons home",
    "server": "4ba92433.2478cc",
    "version": 3,
    "outputs": 2,
    "halt_if": "home",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "group.persons",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 410,
    "y": 160,
    "wires": [
      [
        "ce720787.d6dd18"
      ],
      [
        "49ea77ab.4cfa28",
        "76fc5cd8933d341b",
        "f3398caf62b1ef7a"
      ]
    ]
  },
  {
    "id": "49ea77ab.4cfa28",
    "type": "delay",
    "z": "8aa6edec.5a013",
    "name": "",
    "pauseType": "delay",
    "timeout": "5",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "outputs": 1,
    "x": 740,
    "y": 100,
    "wires": [
      [
        "ab07aadadf97ba44"
      ]
    ]
  },
  {
    "id": "de807278.70c2",
    "type": "link out",
    "z": "8aa6edec.5a013",
    "name": "",
    "links": [
      "e0ebe989.841c68",
      "7b0f1685.0279d8"
    ],
    "x": 1385,
    "y": 140,
    "wires": []
  },
  {
    "id": "5a965a7.3bd68a4",
    "type": "template",
    "z": "8aa6edec.5a013",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "Gast stand is uitgeschakeld {{payload.attributes.friendly_name}} is aanwezig.",
    "output": "str",
    "x": 1260,
    "y": 140,
    "wires": [
      [
        "de807278.70c2"
      ]
    ]
  },
  {
    "id": "ce720787.d6dd18",
    "type": "ha-get-entities",
    "z": "8aa6edec.5a013",
    "name": "lookup person home",
    "server": "4ba92433.2478cc",
    "version": 0,
    "rules": [
      {
        "property": "entity_id",
        "logic": "starts_with",
        "value": "person.",
        "valueType": "str"
      },
      {
        "property": "state",
        "logic": "is",
        "value": "home",
        "valueType": "str"
      }
    ],
    "output_type": "split",
    "output_empty_results": false,
    "output_location_type": "msg",
    "output_location": "payload",
    "output_results_count": 1,
    "x": 780,
    "y": 140,
    "wires": [
      [
        "872aa09a.5c242"
      ]
    ]
  },
  {
    "id": "872aa09a.5c242",
    "type": "join",
    "z": "8aa6edec.5a013",
    "name": "",
    "mode": "custom",
    "build": "string",
    "property": "payload.attributes.friendly_name",
    "propertyType": "msg",
    "key": "topic",
    "joiner": ", ",
    "joinerType": "str",
    "accumulate": false,
    "timeout": "",
    "count": "",
    "reduceRight": false,
    "reduceExp": "",
    "reduceInit": "",
    "reduceInitType": "",
    "reduceFixup": "",
    "x": 950,
    "y": 140,
    "wires": [
      [
        "5a965a7.3bd68a4"
      ]
    ]
  },
  {
    "id": "8afb3387.bc64f",
    "type": "template",
    "z": "8aa6edec.5a013",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "Gast stand is uitgeschakeld en niemand is aanwezig. Lampen zijn uitgeschakeld en beveiliging ingeschakeld. ",
    "output": "str",
    "x": 1260,
    "y": 180,
    "wires": [
      [
        "de807278.70c2"
      ]
    ]
  },
  {
    "id": "fc85d1e2.ac029",
    "type": "template",
    "z": "8aa6edec.5a013",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "Gast stand is ingeschakeld.",
    "output": "str",
    "x": 1260,
    "y": 220,
    "wires": [
      [
        "de807278.70c2"
      ]
    ]
  },
  {
    "id": "f3398caf62b1ef7a",
    "type": "api-current-state",
    "z": "8aa6edec.5a013",
    "name": "state home security off",
    "server": "4ba92433.2478cc",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "input_boolean.home_security",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 780,
    "y": 260,
    "wires": [
      [
        "30a120b8f94715ba"
      ],
      []
    ]
  },
  {
    "id": "30a120b8f94715ba",
    "type": "api-call-service",
    "z": "8aa6edec.5a013",
    "name": "turn on home security",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "input_boolean",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "input_boolean.home_security"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1020,
    "y": 260,
    "wires": [
      [
        "c54e1335a9784d8c"
      ]
    ]
  },
  {
    "id": "c54e1335a9784d8c",
    "type": "template",
    "z": "8aa6edec.5a013",
    "name": "message",
    "field": "message",
    "fieldType": "msg",
    "format": "handlebars",
    "syntax": "mustache",
    "template": "Huis beveiliging is automatisch ingeschakeld",
    "output": "str",
    "x": 1260,
    "y": 260,
    "wires": [
      [
        "de807278.70c2"
      ]
    ]
  },
  {
    "id": "ab07aadadf97ba44",
    "type": "subflow:79544bf2.1ff3a4",
    "z": "8aa6edec.5a013",
    "name": "",
    "x": 960,
    "y": 100,
    "wires": []
  },
  {
    "id": "e98d4730eef641b7",
    "type": "api-call-service",
    "z": "8aa6edec.5a013",
    "name": "turn on switch chime active",
    "server": "4ba92433.2478cc",
    "version": 5,
    "debugenabled": false,
    "domain": "switch",
    "service": "turn_on",
    "areaId": [],
    "deviceId": [],
    "entityId": [
      "switch.doorbell_chime_active"
    ],
    "data": "",
    "dataType": "json",
    "mergeContext": "",
    "mustacheAltTags": false,
    "outputProperties": [],
    "queue": "none",
    "x": 1040,
    "y": 320,
    "wires": [
      []
    ]
  },
  {
    "id": "8d40faa88a9cd112",
    "type": "api-current-state",
    "z": "8aa6edec.5a013",
    "name": "state doorbell chime off",
    "server": "4ba92433.2478cc",
    "version": 3,
    "outputs": 2,
    "halt_if": "off",
    "halt_if_type": "str",
    "halt_if_compare": "is",
    "entity_id": "switch.doorbell_chime_active",
    "state_type": "str",
    "blockInputOverrides": false,
    "outputProperties": [
      {
        "property": "payload",
        "propertyType": "msg",
        "value": "",
        "valueType": "entityState"
      },
      {
        "property": "data",
        "propertyType": "msg",
        "value": "",
        "valueType": "entity"
      }
    ],
    "for": 0,
    "forType": "num",
    "forUnits": "minutes",
    "x": 790,
    "y": 320,
    "wires": [
      [
        "e98d4730eef641b7"
      ],
      []
    ]
  },
  {
    "id": "2e713f167c7e9287",
    "type": "comment",
    "z": "8aa6edec.5a013",
    "name": "the desired state when nobody is home and guest switch is off",
    "info": "",
    "x": 240,
    "y": 40,
    "wires": []
  }
]